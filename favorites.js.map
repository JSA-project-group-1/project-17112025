{"version":3,"file":"favorites.js","sources":["../src/js/main-favorites.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport '/css/pages/favorites.css';\nimport '/css/pages/modal-exercise.css';\nimport '/css/pages/section-exercises.css';\nimport './header.js';\nimport './modal-exercise.js';\nimport { renderQuoteOfTheDay } from './render-functions.js';\nimport iconsUrl from '../assets/icons/icons.svg';\n\nconst FAVORITES_KEY = 'favorite_workouts';\n\nconst mobileBreakpoint = 375;\nconst isMobile = document.documentElement.clientWidth <= mobileBreakpoint;\nconst desktopBreakpoint = 1440;\nconst isDesktop = document.documentElement.clientWidth >= desktopBreakpoint;\n\nimport { renderPagination } from './render-functions';\n\n\nlet favoritesState = [];\nlet currentPage = 1;\nlet pages = 1;\nlet perPage = isMobile ? 8 : (isDesktop ? 1000 : 10);\n\nconst paginationList = document.querySelector('ul.pagination-controls-list');\nconst favoritesList = document.querySelector('ul.favorites-list');\nconst favoritesBlok = document.getElementById('favorites-blok');\n\n// ====== СЕРВІС ДЛЯ localStorage ======\n\nfunction readFavoritesFromStorage() {\n  const raw = localStorage.getItem(FAVORITES_KEY);\n  if (!raw) return [];\n\n  try {\n    const parsed = JSON.parse(raw);\n    return Array.isArray(parsed) ? parsed : [];\n  } catch (err) {\n    console.error('Failed to parse favorites from LS:', err);\n    iziToast.error({\n      message: 'Favorites data is corrupted. Clearing storage.',\n      position: 'topRight',\n      maxWidth: 600,\n    });\n    localStorage.removeItem(FAVORITES_KEY);\n    return [];\n  }\n}\n\nfunction saveFavoritesToStorage(favorites) {\n  localStorage.setItem(FAVORITES_KEY, JSON.stringify(favorites));\n}\n\n// ====== РЕНДЕР ======\n\n\nfunction loadAndRenderFavoriesList() {\n  favoritesList.innerHTML = '';\n  paginationList.innerHTML = '';\n\n  try {\n    favoritesState = readFavoritesFromStorage();\n    pages = Math.max(\n      1,\n      Math.ceil(favoritesState.length / perPage)\n    );\n    const startIndex = (currentPage - 1) * perPage;\n    const endIndex = currentPage * perPage;\n    const itemsForCurrentPage = favoritesState.slice(startIndex, endIndex);\n    renderFavorites(itemsForCurrentPage, favoritesList);\n    if (favoritesState.length > 0) {\n      renderPagination(pages, currentPage, paginationList);\n    }\n  } catch (error) {\n    // warningP.classList.remove('visually-hidden');\n    iziToast.error({\n      icon: '',\n      position: 'topRight',\n      message: error.message,\n    });\n  }\n}\n\nfunction renderFavorites(exercises, list) {\n  if (exercises.length > 0) {\n    const markup = exercises\n      .map(({ _id, name, target, bodyPart, burnedCalories }) => {\n        return `\n    <li class=\"exercises-item\">\n    <div class=\"header-card\">\n    <div class=\"header-left\">\n        <span class=\"type\">WORKOUT</span>\n          <button type=\"button\" class=\"favorite-remove-btn\" data-id=\"${_id}\">\n            <svg class=\"modal-exercise-trash-icon favorite-exercise-trash-icon\" width=\"18\" height=\"18\">\n              <use href=\"${iconsUrl}#icon-trash\"></use></svg>\n            </span>\n          </button>\n       </div>\n       <div class=\"header-right\">\n        <button class=\"start-btn\" type=\"button\" data-modal-exercise=\"open\" data-exercise-id=\"${_id}\"> Start\n        <svg class=\"icon-arrow-right\" width=\"18\" height=\"18\">\n        <use href=\"${iconsUrl}#icon-arrow-1\"></use>\n        </svg>\n        </button>\n        </div>\n        </div>\n    <div class=\"title\">\n      <button type=\"button\" class=\"exercise-rating-btn js-give-rating-btn\" data-exercise-id=\"${_id}\">\n      <svg class=\"icon\" width=\"24\" height=\"24\">\n      <use href=\"${iconsUrl}#icon-run-man-2\"></use>\n      </svg>\n      </button>\n      <span class=\"name-text-exercise\">${name}</span>\n    </div>\n    <div class=\"details\">\n        <ul class=\"exercise-details-list\">\n        <li class=\"calories\">\n        <span class=\"calories-name\">Burned calories</span>\n        <span class=\"calories-value\">${burnedCalories} / 3 min</span>\n        </li>\n        <li class=\"body-part\">\n        <span class=\"body-part-name\">Body part:</span>\n        <span class=\"body-part-value\">${bodyPart}</span>\n        </li>\n        <li class=\"target\">\n        <span class=\"target-name\">Target:</span>\n        <span class=\"target-value\">${target}</span>\n          </li>\n          </ul>\n          </div>\n          </li>\n          `;\n      })\n      .join('');\n    list.innerHTML = markup;\n  } else {\n    list.innerHTML =\n      \"<div class='no-content-warning'><p>It appears that you haven't added any exercises to your favorites yet.To get started, you can add exercises that you like to your favorites for easier access in the future.</p></div>\";\n  }\n}\n\n// ====== СИНХРОНІЗАЦІЯ ПІСЛЯ ЗАКРИТТЯ МОДАЛКИ ======\n\nfunction onModalCloseClick(event) {\n  const closeModal = event.target.closest('[data-modal-exercise=\"close\"]');\n  if (closeModal) {\n    const newState = readFavoritesFromStorage();\n\n    const prev = JSON.stringify(favoritesState);\n    const next = JSON.stringify(newState);\n\n    if (prev === next) return;\n\n    favoritesState = newState;\n\n    favoritesList.innerHTML = '';\n    paginationList.innerHTML = '';\n    pages = Math.max(\n      1,\n      Math.ceil(favoritesState.length / perPage)\n    );\n    renderFavorites(favoritesState, favoritesList);\n    if (favoritesState.length > 0) {\n      renderPagination(pages, currentPage, paginationList);\n    }\n  }\n}\n\n\nfunction onFavoritesListClick(event) {\n  const removeBtn = event.target.closest('button[data-id]');\n  if (removeBtn) {\n    const workoutId = removeBtn.dataset.id;\n    if (!workoutId) return;\n\n    const newFavorites = favoritesState.filter(item => item._id !== workoutId);\n\n    if (newFavorites.length === favoritesState.length) {\n      return;\n    }\n\n    favoritesState = newFavorites;\n    saveFavoritesToStorage(favoritesState);\n\n    favoritesList.innerHTML = '';\n    paginationList.innerHTML = '';\n    pages = Math.max(\n      1,\n      Math.ceil(favoritesState.length / perPage)\n    );\n    renderFavorites(favoritesState, favoritesList);\n    if (favoritesState.length > 0) {\n      renderPagination(pages, currentPage, paginationList);\n    }\n  }\n}\n\nfunction onPaginationClick(event) {\n  const clickedButton = event.target.closest('button[data-page]');\n  if (clickedButton) {\n    try {\n      switch (clickedButton.dataset.page) {\n        case 'beg':\n          currentPage = 1;\n          break;\n\n        case 'prev':\n          currentPage--;\n          break;\n\n        case 'next':\n          currentPage++;\n          break;\n\n        case 'end':\n          currentPage = pages;\n          break;\n\n        default:\n          currentPage = parseInt(clickedButton.dataset.page, 10);\n      }\n\n      const startIndex = (currentPage - 1) * perPage;\n      const endIndex = currentPage * perPage;\n      const itemsForCurrentPage = favoritesState.slice(startIndex, endIndex);\n      renderFavorites(itemsForCurrentPage, favoritesList);\n      if (favoritesState.length > 0) {\n        renderPagination(pages, currentPage, paginationList);\n      }\n\n    } catch (error) {\n      iziToast.error({\n        icon: '',\n        position: 'topRight',\n        message: error.message,\n      });\n    }\n  }\n}\n// ====== INIT ======\n\nfunction initFavoritesPage() {\n  renderQuoteOfTheDay();\n  loadAndRenderFavoriesList()\n\n  favoritesList.addEventListener('click', onFavoritesListClick);\n  paginationList.addEventListener('click', onPaginationClick);\n  document.addEventListener('click', onModalCloseClick);\n}\n\ninitFavoritesPage();\n"],"names":["FAVORITES_KEY","mobileBreakpoint","isMobile","desktopBreakpoint","isDesktop","favoritesState","currentPage","pages","perPage","paginationList","favoritesList","readFavoritesFromStorage","raw","parsed","err","iziToast","saveFavoritesToStorage","favorites","loadAndRenderFavoriesList","startIndex","endIndex","itemsForCurrentPage","renderFavorites","renderPagination","error","exercises","list","markup","_id","name","target","bodyPart","burnedCalories","iconsUrl","onModalCloseClick","event","newState","prev","next","onFavoritesListClick","removeBtn","workoutId","newFavorites","item","onPaginationClick","clickedButton","initFavoritesPage","renderQuoteOfTheDay"],"mappings":"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"}